!function(a){var b=function(a,b,c){this.methods={get:{query:!0},post:{body:!0},put:{body:!0},"delete":{query:!0},head:{query:!0}},this.path=a,this._initOptions(b),this._initHeaders(c),this._initMethods()};b.prototype._initHeaders=function(a){this.headers=a},b.prototype._initOptions=function(a){this.options={charset:"utf-8",autoParse:!0,timeout:3e4,cors:!1,corsWithCredentials:!1};for(var b in a)a.hasOwnProperty(b)&&this.options.hasOwnProperty(b)&&(this.options[b]=a[b])},b.prototype._initMethods=function(){var a=this;for(var c in this.methods)!function(c){b.prototype[c]=function(){var d=Array.prototype.slice.call(arguments);d.unshift(c),b.prototype.request.apply(a,d)}}(c)},b.prototype.request=function(){var a=Array.prototype.slice.call(arguments);if("string"!=typeof a[0]||!(a[0]in this.methods))throw"Invalid method type: "+typeof a[0];var c=this.methods[a[0]];if(a.length>=2&&"function"==typeof a[1]?a.splice(1,0,void 0,void 0):c.query&&a.length>=3&&"function"==typeof a[2]?a.splice(2,0,void 0):c.body&&a.length>=3&&"function"==typeof a[2]&&a.splice(1,0,void 0),4!==a.length&&(5!==a.length||"object"!=typeof a[a.length-1]))throw"Invalid parameters";b.prototype.send.apply(this,a)},b.prototype.send=function(a,b,c,d,e){var f=this.path;b&&Object.keys(b).length>0&&(f+=this._buildQueryString(b));var g=this._buildXHR();g.open(a,f,!0);var h=this._buildHeaders(e,typeof c);for(var i in h)h.hasOwnProperty(i)&&g.setRequestHeader(i,h[i]);var j=setTimeout(function(){g.abort(),d(null,new Error("Request has timed out"),0)},this.options.timeout),k=this;g.onerror=function(){clearTimeout(j),d(null,new Error("A network-level error has occurred"),0)},g.onreadystatechange=function(){clearTimeout(j),4===g.readyState&&k._handleResponse(g.status,g.responseText,g.getAllResponseHeaders(),d)};try{c&&"object"==typeof c?g.send(JSON.stringify(c)):c&&"string"==typeof c?g.send(c):g.send()}catch(l){g.onerror(l)}},b.prototype._handleResponse=function(a,b,c,d){if(0!==a){var e=b,f=c;if(this.options.autoParse){try{f=this._parseResponseHeaders(c)}catch(g){f=new Error("Unable to parse response headers")}if("Content-Type"in f&&f["Content-Type"].indexOf("application/json")>-1)try{e=JSON.parse(e)}catch(g){d(new Error("Unable to parse response body"),null,a,f)}}a>=100&&300>a||304===a?d(e,null,a,f):d(null,e,a,f)}},b.prototype._parseResponseHeaders=function(a){var b={},c=a.split("\n");for(var d in c)if(""!==c[d]){var e=c[d].trim(),f=e.split(":");b[f[0].trim()]=f[1].trim()}return b},b.prototype._buildXHR=function(){if(this.options.cors&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;var a=new XMLHttpRequest;if(this.options.cors&&!("withCredentials"in a))throw"CORS is not supported by this user agent";return this.options.cors&&this.options.corsWithCredentials&&"withCredentials"in a&&(a.withCredentials="true"),a},b.prototype._buildQueryString=function(a){var b;for(var c in a)a.hasOwnProperty(c)&&(b=b?b+"&"+c+"="+a[c]:c+"="+a[c]);return"?"+b},b.prototype._buildHeaders=function(a,b){var c={};for(var d in this.headers)this.headers.hasOwnProperty(d)&&(c[d]=this.headers[d]);"object"===b?c["Content-Type"]="application/json":"string"===b&&(c["Content-Type"]="text/plain; charset="+this.options.charset);for(var e in a)a.hasOwnProperty(e)&&(c[e]=a[e]);return c},"function"==typeof define?define(function(){return b}):a.Discuss=b}(this);